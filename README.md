# ceph

![Debian package](https://img.shields.io/debian/v/ceph/stable?label=ceph%20deb%20stable)

[[_TOC_]]

Введение
--------

[Ceph](https://ceph.io/) - масштабируемая распределенная система хранения.
Ceph модуль устанавливает и настраивает ceph версии [12.2.4 luminous](https://ceph.io/releases/v12-2-4-luminous-released/) на [OS Astra Linux SE 1.6 (Smolensk)](https://astralinux.ru/products/astra-linux-special-edition/).

Описание ceph модуля
------------------

Ceph модуль устанавливает и настраивает компоненты кластера ceph ( MON, MGR, MDS, OSD, CLI ), создаёт pools и монтирует файловую систему [Cephfs](https://docs.ceph.com/en/latest/cephfs/).
Размонтирует файловую систему Cephfs. Удаляет pools. Удаляет компоненты ( MON, MGR, MDS, OSD, CLI ) ceph кластера. 

Что ceph модуль не делает
-----------------------

Модуль не устанавливает ceph на ОС отличную от Astra Linux SE 1.6 (Smolensk).
Установка ceph тестировалась только на операционную систему специального назначения "Astra Linux Special Edition" РУСБ.10015-01 версии 1.6 (ОС СН)
Модуль не удаляет одновременно все до последней компоненты ceph на всём кластере. Принято решение, что для полного удаления целесообразнее делать переразвёртывание кластера.

Обзор системы
----------

В нашем варианте применения компоненты MON, MGR и MDS устанавливаются совместно на сервер. На всех серверах устанавливаются OSD и CLI. Мы развёртываем три MON, MGR и MDS. Создаются два pool, на hdd и ram дисках.

Ограничения
----------

- Имя интерфейса передачи данных серверов ceph должно быть равно имени его Ethernet интерфейса с добавлением суффикса ib в конце. Например, если имя Ethernet интерфейса - pnode01, тогда имя Infiniband интерфейса - pnode01ib. Именно такое имя Infiniband интерфейса ожидается во многих манифестах и скриптах модуля ceph.
- Смонтированные директории ceph должны быть только на серверах кластера ceph, а также только на OSD (у нас OSD на всех серверах), MON, MGR и MDS. Это ограничение связано со скриптом подготовки к выключению кластера ceph.

Установка
----------

Инструкцию по применению модуля ceph развёртыванию и настройку ceph можно найти [здесь](dopdocs/INSTALLATIONS.md)

Идеи доработки
----

Текущие идеи по доработке модуля [здесь](dopdocs/TODO.md)

Знания
----

Заметки и полученные знания, не попавшие в другие разделы документации [здесь](dopdocs/experience.md)

Другие документы
----------

Инструкция по выключению и включению кластера ceph [здесь](dopdocs/instruction-start-stop-ceph.md)

Разработка
----------

Следующие инструкции помогут Вам получить исходный код модуля для разработки и тестирования

```{.bash}
git clone http://gitlab.ext-dc1.o.nkpor.etris:8080/adm/pm/ceph.git
cd ceph
```

Авторы
----------

* @pivushkov ![GitHub followers](https://img.shields.io/github/followers/pivusan?label=Follow&style=social)
* Также, вклад в проект внёс @budnik, ценными замечаниями.
* @antushev не однократно героически восстанавливал по инструкциям сломаный кластер ceph в моё отсутствие
